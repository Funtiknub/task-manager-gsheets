# Система управления задачами с синхронизацией Google Sheets

## Описание
Программа для управления ежедневными задачами с возможностью синхронизации с Google Sheets. Позволяет создавать задачи, отмечать их выполнение и автоматически отправлять в таблицу Google Sheets.

## Необходимые условия
1. Python 3.x
2. Установленные библиотеки:
   ```bash
   pip install keyboard pyperclip
   ```

## Установка зависимостей
Для работы программы необходимо установить следующие библиотеки:
```bash
pip install keyboard pyperclip
```

Библиотеки webbrowser, json, os, datetime, calendar и time входят в стандартную библиотеку Python и не требуют отдельной установки.

3. Доступ к Google Sheets
4. Браузер по умолчанию с авторизацией в Google аккаунте

## Структура файлов
- `todo.py` - основной файл программы
- `google_sheets_sync.py` - модуль синхронизации с Google Sheets
- `tasks.json` - файл хранения задач
- `sheet_settings.json` - настройки доступа к Google Sheets

## Настройка
1. В файле `sheet_settings.json` должны быть указаны:
   ```json
   {
     "spreadsheet_id": "https://docs.google.com/spreadsheets/d/ваш_id_таблицы",
     "start_date": "03.02.2025",
     "start_cell": "A1",
     "start_weekday": 1,
     "exceptions": {
       "additional_workdays": ["15.02.2025", "22.02.2025"],
       "removed_workdays": []
     }
   }
   ```
   - `start_date` - дата начала периода
   - `additional_workdays` - дополнительные рабочие дни (например, рабочие субботы)
   - `removed_workdays` - удаленные рабочие дни (праздники)

Например:
- Если первый день периода (03.02.2025) находится в ячейке A1 и это понедельник (1)
- То следующий рабочий день (04.02.2025) будет в ячейке D1
- А первый день следующей недели (10.02.2025) будет в ячейке P1

Каждый рабочий день занимает 3 колонки в таблице.

## Использование

### Запуск программы через bat-файл
В комплекте идет файл `run_todo.bat` для быстрого запуска программы. 

### Настройка bat-файла
По умолчанию bat-файл настроен на путь:
```bat
cd /d C:\Users\ИМЯ_ПОЛЬЗОВАТЕЛЯ\Desktop\task-manager-gsheets
```

Если вы переместили папку проекта в другое место, необходимо изменить путь в bat-файле:
1. Откройте файл `run_todo.bat` в любом текстовом редакторе
2. Измените путь на актуальный (где находится файл todo.py)
3. Сохраните файл

Примеры путей:
- Если папка на рабочем столе: `C:\Users\ИМЯ_ПОЛЬЗОВАТЕЛЯ\Desktop\task-manager-gsheets`
- Если папка в документах: `C:\Users\ИМЯ_ПОЛЬЗОВАТЕЛЯ\Documents\task-manager-gsheets`
- Если папка на диске D: `D:\task-manager-gsheets`

### Важно
- Путь должен вести к папке, где находится файл todo.py
- В пути используйте обратный слеш `\`
- Если в пути есть пробелы, заключите его в кавычки: `cd /d "C:\Program Files\My Folder"`

### Основное меню
1. **Работа с задачами** - добавление новых задач
2. **Отметить задачу как выполненную** - отметка о выполнении + комментарий
3. **Показать задачи** - просмотр всех задач
4. **Настройка доступа Google Таблицы** - настройка доступа
5. **Синхронизировать с Google Таблицей** - отправка задач в таблицу
6. **Выход**

### Работа с задачами
1. При первом запуске введите имя пользователя
2. Для добавления задачи выберите пункт 1
3. Для отметки выполнения выберите пункт 2:
   - Введите номер задачи
   - Добавьте комментарий (комментарии накапливаются)
   - Можно добавить срочную задачу и сразу отметить её как выполненную

### Синхронизация с Google Sheets
1. Выберите пункт 5 в меню
2. Таблица откроется автоматически на нужной дате
3. Используйте горячие клавиши:
   - `F8` - вставка всех задач на день в ячейки текущего дня
   - `F9` - вставка выполненных задач в ячейки выполненных задач
   - `ESC` - выход из режима синхронизации

### Особенности
- Задачи на день вставляются в две объединенные ячейки справа от текущей даты (например, если дата в BI1, то задачи будут в BJ2:BK2)
- Выполненные задачи вставляются в две объединенные ячейки на 22 строки ниже от ячеек с задачами на день
- F8 и F9 работают независимо
- Нумерация выполненных задач соответствует их номерам в общем списке
- Комментарии к выполненным задачам накапливаются
- Программа учитывает только рабочие дни (пн-пт + доп. рабочие дни из настроек)

## Важно
- Браузер должен быть авторизован в Google аккаунте
- Таблица должна быть доступна для редактирования
- Все даты вводятся в формате ДД.ММ.ГГГГ
- Для выхода из режима синхронизации нажмите ESC

## Лицензия
MIT License

Copyright (c) 2025

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## Отказ от ответственности
Данное программное обеспечение предоставляется "как есть", без каких-либо гарантий. Авторы не несут ответственности за любой прямой или косвенный ущерб, возникший в результате использования данного программного обеспечения. Используя это программное обеспечение, вы соглашаетесь с тем, что:

1. Авторы не гарантируют бесперебойную работу программы
2. Возможны ошибки при синхронизации с Google Sheets
3. Вы используете программу на свой страх и риск
4. Авторы не несут ответственности за потерю или искажение данных
5. Вы обязуетесь создавать резервные копии важных данных

Перед использованием рекомендуется протестировать программу на тестовых данных.
